<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${course.title}">Название курса</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* Стили остаются без изменений */
        :root {
            --primary-dark: #0a0a14;
            --secondary-dark: #121225;
            --accent-blue: #1a5fb4;
            --accent-light-blue: #3584e4;
            --text-light: #f5f5f7;
            --text-gray: #a1a1a6;
            --border-dark: #2a2a3c;
            --code-bg: #161b22;
            --code-border: #30363d;
            --success: #39d353;
            --danger: #f85149;
        }

        * { margin:0; padding:0; box-sizing:border-box; }
        body {
            background-color: var(--primary-dark);
            color: var(--text-light);
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            line-height: 1.6;
            padding-top: 80px;
        }

        .navbar-custom {
            background-color: var(--secondary-dark) !important;
            border-bottom: 1px solid var(--border-dark);
            padding: 12px 0;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
        }

        .navbar-brand { color: var(--accent-light-blue) !important; font-weight: bold; font-size: 24px; }
        .navbar-nav .nav-link { color: var(--text-light) !important; font-weight: 500; }
        .navbar-nav .nav-link:hover { color: var(--accent-light-blue) !important; }
        .dropdown-menu { background-color: var(--primary-dark); border: 1px solid var(--border-dark); }
        .dropdown-item { color: var(--text-light); }
        .dropdown-item:hover { background-color: var(--accent-blue); color:white; }

        .btn-outline-custom { border:1px solid var(--accent-blue); color: var(--accent-blue); }
        .btn-primary-custom { background-color: var(--accent-blue); color:white; border:none; }
        .btn-outline-custom:hover, .btn-primary-custom:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .avatar-nav { width:42px; height:42px; border-radius:50%; object-fit:cover; border:2px solid var(--accent-blue); }

        .sidebar { position: fixed; top:80px; left:0; bottom:0; width:340px; background: var(--secondary-dark); border-right:1px solid var(--border-dark); overflow-y:auto; padding-bottom:80px; z-index:900; }
        .sidebar-header { padding:24px 20px 16px; border-bottom:1px solid var(--border-dark); }
        .sidebar-header h5 { font-size:18px; font-weight:600; margin-bottom:8px; }
        .sidebar-progress { font-size:14px; color: var(--text-gray); }

        .accordion-flush .accordion-item { background: transparent; border: none; }
        .accordion-button { background: transparent; color: var(--text-light); font-weight: 500; padding:12px 20px; border-radius:0; }
        .accordion-button:not(.collapsed) { background: rgba(255,255,255,0.05); color: var(--accent-light-blue); box-shadow:none; }
        .accordion-button:focus { box-shadow:none; }
        .accordion-body { padding:0 20px 16px; }

        .lesson-link { color:white; display:flex; justify-content:space-between; align-items:center; padding:10px 16px; margin:3px 0; border-radius:6px; transition:all 0.2s; font-size:15px; }
        .lesson-link a { color: inherit; text-decoration:none; flex:1; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
        .lesson-link:hover { background: var(--accent-blue); }
        .lesson-link.active { background: #22863a; font-weight:600; }
        .lesson-link.active a { color:white; }
        .completed-icon { opacity:0; transition: opacity 0.3s; }
        .lesson-link.completed .completed-icon { opacity:1; color: var(--success); }

        .main-content { margin-left:340px; min-height: calc(100vh - 80px); }

        @media (max-width:992px) {
            .sidebar { position: static; width:100%; height:auto; border-right:none; border-bottom:1px solid var(--border-dark); }
            .main-content { margin-left:0; }
        }

        .lesson-header { background: linear-gradient(135deg, var(--secondary-dark) 0%, var(--primary-dark) 100%); padding:60px 0 40px; border-bottom:1px solid var(--border-dark); }
        .progress { height:10px; background-color: var(--border-dark); border-radius:6px; overflow:hidden; }
        .progress-bar { background-color: var(--accent-light-blue); transition: width 0.6s ease; }
        .content-card, .quiz-card { background-color: var(--secondary-dark); border-radius:12px; padding:40px; box-shadow:0 10px 30px rgba(0,0,0,0.4); margin-bottom:30px; }
        pre code { font-family: 'JetBrains Mono', monospace; font-size:15px; line-height:1.5; }
        .btn-lesson-nav { background-color:#2a2a3c !important; color: var(--text-light) !important; border:1px solid var(--border-dark) !important; padding:12px 24px; border-radius:8px; font-weight:500; transition:all 0.3s; }
        .btn-lesson-nav:hover { background-color: var(--accent-blue) !important; color:white !important; border-color: var(--accent-light-blue) !important; transform: translateY(-2px); box-shadow:0 4px 12px rgba(26,95,180,0.3); }
        .btn-prev { margin-right:auto; } .btn-next { margin-left:auto; }
        .lesson-navigation { display:flex; justify-content:space-between; align-items:center; margin-top:30px; gap:15px; }
        pre {
            background: var(--code-bg);
            border: 1px solid var(--code-border);
            border-radius: 8px;
            padding: 20px;
            overflow-x: auto;
            margin: 25px 0;
        }

        pre code {
            font-family: 'JetBrains Mono', Consolas, monospace;
            font-size: 15px;
            line-height: 1.5;
        }
    </style>
</head>
<body>
<div class="container-fluid">
    <div class="row">
        <!-- Sidebar with course navigation -->
        <div class="col-md-3 sidebar">
            <div class="p-3">
                <h4 th:text="${course.title}">Название курса</h4>
                <p class="text-muted" th:text="${course.description}">Описание курса</p>

                <hr>

                <!-- Navigation through all pages -->
                <h6>Навигация по страницам:</h6>
                <div class="list-group">
                    <a th:each="pageItem, iter : ${pages}"
                       th:href="@{/course/{id}/{pageNum}(id=${course.id}, pageNum=${iter.index})}"
                       th:class="|list-group-item list-group-item-action ${page.id == pageItem.id} ? 'active-page' : ''|"
                       th:text="|Страница ${iter.index + 1}: ${pageItem.title}|">
                        Страница
                    </a>
                </div>

                <!-- Course structure tree -->
                <hr>
                <h6>Структура курса:</h6>
                <div th:each="module : ${course.modules}" class="mb-2">
                    <div class="fw-bold text-primary"
                         th:text="'Модуль ' + ${module.ordering} + ': ' + ${module.title}">
                        Модуль
                    </div>

                    <div th:each="lesson : ${module.lessons}" class="ms-3">
                        <div class="fw-semibold"
                             th:text="'Урок ' + ${lesson.ordering} + ': ' + ${lesson.title}">
                            Урок
                        </div>

                        <div class="lesson-pages">
                            <div th:each="lessonPage : ${lesson.pages}"
                                 class="small"
                                 th:class="${lessonPage.id == page.id} ? 'text-primary fw-bold' : 'text-muted'">
                                • <span th:text="${lessonPage.title}">Страница</span>
                                <span class="badge bg-secondary" th:text="${lessonPage.type}">TEXT</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main content area -->
        <div class="col-md-9 content-area">
            <div class="p-4">
                <!-- Current page content -->
                <div th:object="${page}">
                    <!-- Breadcrumb -->
                    <nav aria-label="breadcrumb" class="mb-4">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item">
                                <span th:text="${course.title}">Курс</span>
                            </li>
                            <li class="breadcrumb-item active" th:text="*{title}">Текущая страница</li>
                        </ol>
                    </nav>

                    <!-- Page title and type -->
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2 th:text="*{title}">Заголовок страницы</h2>
                        <span class="badge"
                              th:class="*{type} == 'TEXT' ? 'bg-info' : 'bg-warning'"
                              th:text="*{type}">TYPE</span>
                    </div>

                    <!-- Page content based on type -->
                    <div th:switch="*{type}">
                        <!-- TEXT page type -->
                        <div th:case="TEXT">
                            <div class="card">
                                <div class="card-body">
                                    <div th:utext="*{content}" class="card-text">
                                        Содержание страницы
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Default case for other types -->
                        <div th:case="*">
                            <div class="alert alert-warning">
                                Тип страницы не поддерживается: <span th:text="*{type}"></span>
                            </div>
                            <div th:if="*{content}" class="card">
                                <div class="card-body">
                                    <p th:text="*{content}" class="card-text">Содержание</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // Auto-play video when page loads
    document.addEventListener('DOMContentLoaded', function() {
        const video = document.querySelector('video');
        if (video) {
            video.play().catch(function(error) {
                console.log('Auto-play was prevented:', error);
            });
        }
    });
</script>
</body>
</html>